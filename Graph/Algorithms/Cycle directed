def dfs(node):
    if node in rec_stack:
        return True
    if node in visited:
        return False
    
    visited.add(node)
    rec_stack.add(node)
    
    for neighbor in graph[node]:
        if neighbor == node:   # self-loop check
            return True
        if dfs(neighbor):
            return True
    
    rec_stack.remove(node)
    return False
